import{d as P,a as D,r as N,w as f,k as u,g as A,o as S,j as n,e as r,f as d,i as U,B as E,u as s,v as R,n as T,t as j,x as q,s as v,E as m}from"./index-DFYbR7MT.js";import{u as z,m as F,n as H}from"./useFileSystem-BHA1_ldw.js";const K={class:"move_wrapper"},L={class:"flex_bet"},$={style:{display:"flex","align-items":"center",gap:"8px"}},G=["src"],J={class:"dialog-footer"},X=P({__name:"MoveDest",props:{curPath:{type:Array,required:!0,default:()=>[]},moveVisiable:{type:Boolean,default:!1},moveWhich:{type:Array,default:()=>[]}},emits:["update:moveVisiable"],setup(_,{emit:b}){const o=_,g=b,{path:l,breadcrumbList:w,cdUp:p,loadIcons:y,getIconUrl:k,files:V,loadTableData:h,eventName:x,handleRowClick:C}=z();D(()=>{y(),h()});const i=N(o.moveVisiable);f(()=>o.moveVisiable,a=>{a&&(l.splice(0,l.length,...o.curPath),h()),i.value=a},{immediate:!0}),f(i,a=>{g("update:moveVisiable",a)});const I=async()=>{if(o.moveWhich.length>=1){const a=o.moveWhich[0];if(l.some(t=>t.id===a?.id)){m.warning("不能选择当前文件夹及其子孙文件夹");return}if(l[l.length-1]?.id===a?.parentId||l.length===1&&a?.parentId===null){m.warning("当前文件（夹）就在这个位置，无需移动");return}const e=l[l.length-1]?.id;if(o.moveWhich.length===1)try{await F({id:a?.id,parentId:e===-1?null:e}),i.value=!1}catch(t){m.error("移动失败: "+t)}else if(o.moveWhich.length>1)try{await H({itemIds:o.moveWhich.map(t=>t.id),targetParentId:e===-1?null:e}),i.value=!1}catch(t){m.error("移动失败: "+t)}}};return(a,e)=>{const t=u("el-button"),B=u("el-table-column"),M=u("el-table"),W=u("el-dialog");return S(),A(W,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=c=>i.value=c),title:"文件上传",width:"460"},{footer:n(()=>[r("div",J,[d(t,{onClick:e[0]||(e[0]=c=>i.value=!1)},{default:n(()=>[...e[2]||(e[2]=[v("取消",-1)])]),_:1}),d(t,{type:"primary",onClick:I},{default:n(()=>[...e[3]||(e[3]=[v("确认",-1)])]),_:1})])]),default:n(()=>[r("div",K,[r("div",L,[d(E,{"breadcrumb-list":s(w),sepa:"/",clickable:!0,onMenuClick:s(p)},null,8,["breadcrumb-list","onMenuClick"]),U(d(t,{icon:"Back",onClick:s(p),size:"small"},null,8,["onClick"]),[[R,s(l).length>1]])]),d(M,T({data:s(V)},{[j(s(x))]:s(C)}),{default:n(()=>[d(B,{prop:"name",label:"文件名","show-overflow-tooltip":""},{default:n(c=>[r("div",$,[r("img",{src:s(k)(c.row),alt:"icon",style:{width:"18px",height:"18px"}},null,8,G),r("span",null,q(c.row.name),1)])]),_:1})]),_:1},16,["data"])])]),_:1},8,["modelValue"])}}});export{X as default};
