import{d as D,a as N,r as P,w as v,k as c,f as S,o as U,h as n,b as i,e as r,l as q,B as E,u as a,v as R,m as T,t as j,s as z,q as f,E as m}from"./index-CtTvRn_z.js";import{u as A,m as F}from"./useFileSystem-C7trFcMb.js";const H={class:"move_wrapper"},K={class:"flex_bet"},L={style:{display:"flex","align-items":"center",gap:"8px"}},O=["src"],$={class:"dialog-footer"},Q=D({__name:"MoveDest",props:{curPath:{type:Array,required:!0,default:()=>[]},moveVisiable:{type:Boolean,default:!1},moveWhich:{type:Object,default:null}},emits:["update:moveVisiable"],setup(_,{emit:b}){const o=_,g=b,{path:t,breadcrumbList:w,cdUp:p,loadIcons:y,getIconUrl:k,files:V,loadTableData:h,eventName:C,handleRowClick:x}=A();N(()=>{y(),h()});const s=P(o.moveVisiable);v(()=>o.moveVisiable,e=>{e&&(t.splice(0,t.length,...o.curPath),h()),s.value=e},{immediate:!0}),v(s,e=>{g("update:moveVisiable",e)});const B=async()=>{if(t.some(e=>e.id===o.moveWhich.id)){m.warning("不能选择当前文件夹及其子孙文件夹");return}if(t[t.length-1]?.id===o.moveWhich.parentId||t.length===1&&o.moveWhich.parentId===null){m.warning("当前文件（夹）就在这个位置，无需移动");return}try{const e=t[t.length-1]?.id;await F({id:o.moveWhich.id,parentId:e===-1?null:e}),s.value=!1}catch{m.error("移动失败")}};return(e,l)=>{const u=c("el-button"),M=c("el-table-column"),I=c("el-table"),W=c("el-dialog");return U(),S(W,{modelValue:s.value,"onUpdate:modelValue":l[1]||(l[1]=d=>s.value=d),title:"文件上传",width:"460"},{footer:n(()=>[i("div",$,[r(u,{onClick:l[0]||(l[0]=d=>s.value=!1)},{default:n(()=>[...l[2]||(l[2]=[f("取消",-1)])]),_:1}),r(u,{type:"primary",onClick:B},{default:n(()=>[...l[3]||(l[3]=[f("确认",-1)])]),_:1})])]),default:n(()=>[i("div",H,[i("div",K,[r(E,{"breadcrumb-list":a(w),sepa:"/",clickable:!0,onMenuClick:a(p)},null,8,["breadcrumb-list","onMenuClick"]),q(r(u,{icon:"Back",onClick:a(p),size:"small"},null,8,["onClick"]),[[R,a(t).length>1]])]),r(I,T({data:a(V)},{[j(a(C))]:a(x)}),{default:n(()=>[r(M,{prop:"name",label:"文件名","show-overflow-tooltip":""},{default:n(d=>[i("div",L,[i("img",{src:a(k)(d.row),alt:"icon",style:{width:"18px",height:"18px"}},null,8,O),i("span",null,z(d.row.name),1)])]),_:1})]),_:1},16,["data"])])]),_:1},8,["modelValue"])}}});export{Q as default};
