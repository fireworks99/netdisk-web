import{u as D,f as E,r as F,l as V}from"./useFileSystem-BHA1_ldw.js";import{d as Y,a as U,c as $,f as n,e as o,j as s,u as a,k as i,m as f,o as y,g as j,h as H,x as I,s as C,E as g,A as R,y as A}from"./index-DFYbR7MT.js";const P={style:{display:"flex","align-items":"center",gap:"8px"}},q=["src"],G={class:"table-operations"},J={class:"flex_center",style:{"margin-top":"16px"}},Q=Y({__name:"Recycle",setup(K){const{loadIcons:h,getIconUrl:x,deleted:b,pageNum:c,pageSize:p,files:v,total:z,loadTableData:u,handleCurrentChange:k,handleSizeChange:w,layoutStore:S}=D();U(()=>{b.value=!0,h(),u()});const B=async l=>{try{await F(l.id),g({type:"success",message:"恢复成功"}),u()}catch(t){console.log(t)}},M=async l=>{R.confirm(`确认彻底删除 ${l.name} 吗？`,"提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{await V(l.id),u(),g({type:"success",message:"删除成功"})}).catch(()=>{g({type:"info",message:"未删除"})})};return(l,t)=>{const r=i("el-table-column"),_=i("el-button"),N=i("el-table"),T=i("el-pagination");return y(),$("div",null,[n(N,{data:a(v),style:{width:"100%"}},{default:s(()=>[n(r,{prop:"name",label:"文件名","show-overflow-tooltip":""},{default:s(e=>[o("div",P,[o("img",{src:a(x)(e.row),alt:"icon",style:{width:"18px",height:"18px"}},null,8,q),o("span",null,I(e.row.name),1)])]),_:1}),n(r,{prop:"fileSize",label:"大小",align:"center",formatter:(e,m,d)=>a(E)(d)},null,8,["formatter"]),a(S).isMobile?H("",!0):(y(),j(r,{key:0,prop:"createTime",label:"上传时间",align:"center",formatter:(e,m,d)=>a(A)(d).format("YYYY-MM-DD HH:mm:ss")},null,8,["formatter"])),n(r,{label:"操作",align:"center",width:"188"},{default:s(({row:e})=>[o("div",G,[n(_,{size:"small",onClick:m=>B(e)},{default:s(()=>[...t[2]||(t[2]=[C("恢复",-1)])]),_:1},8,["onClick"]),n(_,{size:"small",type:"danger",onClick:m=>M(e)},{default:s(()=>[...t[3]||(t[3]=[C("彻底删除",-1)])]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["data"]),o("div",J,[n(T,{"current-page":a(c),"onUpdate:currentPage":t[0]||(t[0]=e=>f(c)?c.value=e:null),"page-size":a(p),"onUpdate:pageSize":t[1]||(t[1]=e=>f(p)?p.value=e:null),"page-sizes":[10,20,30,40],layout:"total, sizes, prev, pager, next",total:a(z),onSizeChange:a(w),onCurrentChange:a(k),size:"small"},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])}}});export{Q as default};
